(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{220:function(e,t,n){},244:function(e,t,n){},245:function(e,t,n){},246:function(e,t,n){},248:function(e,t,n){},280:function(e,t,n){},281:function(e,t,n){},282:function(e,t,n){},283:function(e,t,n){},307:function(e,t){},309:function(e,t){},318:function(e,t,n){},337:function(e,t,n){},338:function(e,t,n){},339:function(e,t,n){},340:function(e,t,n){},354:function(e,t,n){"use strict";n.r(t);var a=n(18),c=n.n(a),r=n(116),i=n(19),s=n(382),o=(n(220),n(1));function l(){return Object(o.jsx)("div",{className:"login-page-div",children:Object(o.jsxs)("div",{className:"login-page",children:[Object(o.jsx)("div",{className:"title",children:Object(o.jsx)("h1",{children:"Welcome to Couplove!"})}),Object(o.jsxs)(s.a,{variant:"contained",onClick:function(){window.location.href="/auth/google"},id:"home-login-btn",children:[Object(o.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg",className:"g-logo"}),"\xa0\xa0Login With Google"]})]})})}var d=n(8),u=n.n(d),j=n(81),b=n(11),h=n(42),m=n(6),f=n(0),O=n(9),p=n.n(O),v=(n(244),n(245),n(394)),g=n(166),x=n.n(g),y=n(386),w=n(55),I=n.n(w);function k(e){var t=e.reqInfo,n=e.setHavePartner,a=e.setRequestList,c="/gridFs/getOtherProfile/"+t.senderId;function r(){return(r=Object(b.a)(u.a.mark((function e(n){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),(c=new FormData).append("senderId",t.senderId),e.next=5,p()({method:"post",url:"/user/declineUser",data:c,header:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e?a((function(e){return e.filter((function(e){return e.senderId!==t.senderId}))})):alert("Opps something wrong with the server")}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.jsxs)("div",{className:"info-div",children:[Object(o.jsx)("div",{className:"info-sender-profile-div",children:Object(o.jsx)(v.a,{id:"info-sender-avatar",src:c})}),Object(o.jsxs)("div",{className:"info-sender-desc",children:[t.senderNickname," wants to be your partner",Object(o.jsx)("br",{}),Object(o.jsx)(y.a,{id:"info-req-option",onClick:function(e){e.preventDefault();var c=new FormData;c.append("senderId",t.senderId),p()({method:"post",url:"/user/acceptRequest",data:c,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e.result&&(a((function(e){return e.filter((function(e){return e.senderId!==t.senderId}))})),n(!0))}))},children:Object(o.jsx)(x.a,{})}),Object(o.jsx)(y.a,{id:"info-req-option",onClick:function(e){return r.apply(this,arguments)},children:Object(o.jsx)(I.a,{})})]})]})}function N(e){var t=e.requestList,n=e.setHavePartner,a=e.setRequestList;return Object(o.jsx)("div",{className:"req-list-div",children:t.map((function(e){return Object(o.jsx)(k,{setRequestList:a,reqInfo:e,setHavePartner:n})}))})}var C=n(167),S=n.n(C),B=n(96),E=n.n(B);function D(e){var t=e.handleSendReq,n=e.formRef,a=e.havePartner,c=e.requestList,r=e.setHavePartner,i=e.setRequestList,s=e.isHome,l=Object(f.useState)(!1),d=Object(m.a)(l,2),j=d[0],h=d[1];function O(){return(O=Object(b.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p()({method:"post",url:"/home/checkExist"});case 2:return(n=new FormData).append("file",t.target.files[0]),e.next=6,p()({method:"post",url:"/home/upload",data:n,headers:{"Content-Type":"multipart/formdata"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){window.location.reload()}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.jsxs)("div",{className:"nav-div",children:[Object(o.jsx)("div",{className:"nav-title",onClick:function(){return window.open("/","_self")},children:Object(o.jsx)("h3",{children:"Couplove"})}),Object(o.jsxs)("div",{className:"nav-activity-div",children:[Object(o.jsx)("div",{className:"nav-activity logout",onClick:function(){return window.location.href="/auth/logout"},children:"Logout"}),s&&Object(o.jsx)(y.a,{style:{color:"white"},onClick:function(){return document.getElementById("background-file").click()},children:Object(o.jsx)(E.a,{})}),s&&Object(o.jsx)("input",{type:"file",hidden:!0,id:"background-file",onChange:function(e){return O.apply(this,arguments)},name:"file"}),Object(o.jsx)("div",{className:"nav-activity profile",onClick:function(){return window.location.href="/userProfileForm"},children:"Profile"}),a&&Object(o.jsx)("div",{className:"nav-activity chat",onClick:function(){return window.open("/chatRoom","_self")},children:"Chat Room"}),a&&Object(o.jsx)("div",{className:"nav-activity cinema",onClick:function(){return window.open("/cinema","_self")},children:"Cinema"}),a&&Object(o.jsx)("div",{className:"nav-activity memory",onClick:function(){return window.open("/memoryBook","_self")},children:"Memory Book"}),!a&&Object(o.jsx)("div",{className:"nav-sendRequest",children:Object(o.jsxs)("form",{onSubmit:t,ref:n,children:[Object(o.jsx)("input",{type:"text",id:"reqId",name:"reqId",placeholder:"Partner ID"}),Object(o.jsx)("input",{type:"submit",value:"+",className:"nav-submit"})]})}),!a&&Object(o.jsxs)("div",{className:"nav-request",children:[Object(o.jsx)(y.a,{style:{color:"whitesmoke"},onClick:function(){return h(!j)},children:Object(o.jsx)(S.a,{})}),j&&Object(o.jsx)(N,{requestList:c,setHavePartner:r,setRequestList:i})]})]})]})}n(246);var P=n(104),F=n.n(P),R=n(23),M=n(391),T=n(83);function L(){var e,t=Object(f.useState)(),n=Object(m.a)(t,2),a=n[0],c=n[1],r=Object(f.useState)(),i=Object(m.a)(r,2),l=i[0],d=i[1],O=Object(f.useState)(!1),v=Object(m.a)(O,2),g=v[0],x=v[1],w=Object(f.useState)([]),k=Object(m.a)(w,2),N=k[0],C=k[1],S=Object(f.useState)(!1),B=Object(m.a)(S,2),E=B[0],P=B[1],L=Object(f.useState)(!1),A=Object(m.a)(L,2),_=A[0],q=A[1],W=Object(f.useState)(!1),U=Object(m.a)(W,2),z=U[0],Y=U[1],V=Object(f.useState)(!1),H=Object(m.a)(V,2),J=H[0],G=H[1],K=Object(f.useState)(!1),Z=Object(m.a)(K,2),X=Z[0],$=Z[1],Q=Object(f.useState)(),ee=Object(m.a)(Q,2),te=ee[0],ne=ee[1],ae=Object(f.useState)(),ce=Object(m.a)(ae,2),re=ce[0],ie=ce[1],se=Object(f.useState)(),oe=Object(m.a)(se,2),le=oe[0],de=oe[1],ue=Object(f.useState)(),je=Object(m.a)(ue,2),be=je[0],he=je[1],me=Object(f.useState)(),fe=Object(m.a)(me,2),Oe=fe[0],pe=fe[1],ve=Object(f.useState)(),ge=Object(m.a)(ve,2),xe=ge[0],ye=ge[1],we=Object(f.useState)(),Ie=Object(m.a)(we,2),ke=Ie[0],Ne=Ie[1],Ce=Object(f.useState)(""),Se=Object(m.a)(Ce,2),Be=Se[0],Ee=Se[1],De=Object(f.useState)(!0),Pe=Object(m.a)(De,2),Fe=Pe[0],Re=(Pe[1],Object(f.useState)()),Me=Object(m.a)(Re,2),Te=Me[0],Le=Me[1],Ae=Object(f.useRef)(),_e=Object(f.useRef)(),qe=Object(f.useRef)(),We={"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"};function Ue(e){var t=new Date(parseInt(Date.parse(e),10)),n=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0");t.getFullYear();return n+" "+We[a]}function ze(e){e.preventDefault();var t=new FormData(Ae.current);p()({method:"post",url:"/user/sendRequest",data:t,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e.isSent?alert("sent!"):(alert(e.status),console.log(e))})),document.getElementById("reqId").value=""}function Ye(e){"special"===e?document.getElementById("hover-special").style.opacity="1":"day"===e?document.getElementById("hover-day").style.opacity="1":"bday"===e&&(document.getElementById("hover-bday").style.opacity="1")}function Ve(e){"special"===e?document.getElementById("hover-special").style.opacity="0":"day"===e?document.getElementById("hover-day").style.opacity="0":"bday"===e&&(document.getElementById("hover-bday").style.opacity="0")}function He(e){return Je.apply(this,arguments)}function Je(){return(Je=Object(b.a)(u.a.mark((function e(t){var n,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("day"!==t){e.next=12;break}if(!J){e.next=8;break}return(n=new FormData).append("type",t),e.next=6,p()({method:"post",url:"/widget/createWidget",data:n,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){P(!0)}));case 6:e.next=10;break;case 8:document.getElementById("noDayWidget").style.display="none",$(!0);case 10:e.next=24;break;case 12:if("bday"!==t){e.next=19;break}return(a=new FormData).append("type","bday"),e.next=17,p()({method:"post",url:"/widget/createWidget",data:a,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e&&Y(!0)}));case 17:e.next=24;break;case 19:if("special"!==t){e.next=24;break}return(c=new FormData).append("type","special"),e.next=24,p()({method:"post",url:"/widget/createWidget",data:c,headers:{"Content-Type":"multipart/formdata"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e&&q(!0)}));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(){return(Ge=Object(b.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),(n=new FormData(qe.current)).append("type","day"),e.next=5,p()({method:"post",url:"/widget/createWidget",data:n,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){$(!1),P(!0)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(e){"day"===e?document.getElementById("home-delete-dayWidget").style.visibility="visible":"bday"===e?document.getElementById("home-delete-bdayWidget").style.visibility="visible":"special"===e&&(document.getElementById("home-delete-specialWidget").style.visibility="visible")}function Ze(){E&&(document.getElementById("home-delete-dayWidget").style.visibility="hidden"),z&&(document.getElementById("home-delete-bdayWidget").style.visibility="hidden"),_&&(document.getElementById("home-delete-specialWidget").style.visibility="hidden")}function Xe(e){return $e.apply(this,arguments)}function $e(){return($e=Object(b.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("type",t),e.next=4,p()({method:"post",url:"/widget/deleteWidget",data:n,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e&&("day"===t&&P(!1),"bday"===t&&Y(!1),"special"===t&&q(!1))}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.useEffect)((function(){var e=new AbortController;return p.a.get("/auth/isLoggedIn").then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){if(!1===e.isLoggedIn)window.open("/login","_self");else if(void 0===e.user.nickname)window.open("/userProfileForm","_self");else{p.a.get("/home/getBackground").then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e?(Ee("/home/getBackground"),document.getElementById("foreground").style.visibility="hidden"):(Ee("https://s3-us-west-2.amazonaws.com/s.cdpn.io/751678/my-illustration-background.png"),document.getElementById("foreground").style.visibility="visible")}));var t=new Date(e.user.dateOfRelationship),n="0"+(t.getMonth()+1)+"/"+t.getDate(),a=[{date:"02/14",event:"Valentines Day"},{date:"05/20",event:"520 Day"},{date:"12/25",event:"Christmas Day"},{date:"12/31",event:"New Year Eve"},{date:n,event:"Anniversary Day"}];if(d(e.partnerInfo),c(e.user),null!==e.user.dateOfRelationship&&(G(!0),Le(e.user.dateOfRelationship),e.widget))for(var r=0;r<e.widget.widget.length;r++)if("day"===e.widget.widget[r].type){P(!0);var i=new Date,s=new Date(e.user.dateOfRelationship),o=i.getTime()-s.getTime();ne(parseInt(o/864e5)+1)}else if("bday"===e.widget.widget[r].type){var l=Ue(e.partnerInfo.dateOfBirth),u=Ue(e.user.dateOfBirth);de(l),ie(u);var j=new Date,b=new Date(e.partnerInfo.dateOfBirth),m=new Date(e.user.dateOfBirth);b.setFullYear(j.getFullYear()),m.setFullYear(j.getFullYear()),j>b&&b.setFullYear(j.getFullYear()+1),j>m&&m.setFullYear(j.getFullYear()+1);var f=parseInt((b.getTime()-j.getTime())/864e5),O=parseInt((m.getTime()-j.getTime())/864e5);pe(0===f?"Today is your partner's Birthday!":Math.abs(f)),he(0===O?"Today is your Birthday!":Math.abs(O)),Y(!0)}else"special"===e.widget.widget[r].type&&function(){q(!0);var e=new Date,t=e.getFullYear(),c=99999999999;a.map((function(n){var a=new Date(t+"/"+n.date);e>a&&a.setFullYear(e+1);var r=Math.abs(parseInt(e.getTime()-a.getTime())/864e5);r<c&&(c=r+1,ye(n.event))})),0===Math.round(c)?Ne("Today is "+n.event+" !"):Ne(Math.round(c))}();p()({method:"get",url:"/user/getRequest",headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){var t=[];e.requests.map((function(e){t.push(Object(h.a)({},e))})),C(t)})),null!==e.user.partner&&x(!0)}})),function(){e.abort()}}),[E,_,z]),N.map((function(e){console.log(e)})),Object(o.jsxs)("div",{className:"home-div",children:[Object(o.jsx)(D,(e={isHome:Fe,setRequestList:C,setHavePartner:x,requestList:N,havePartner:g,handleSendReq:ze,formRef:Ae,handleLogout:function(){window.location.href="/auth/logout"}},Object(j.a)(e,"handleSendReq",ze),Object(j.a)(e,"acceptRef",_e),e)),Object(o.jsxs)("div",{className:"home-background",style:{backgroundImage:"url("+Be+")"},children:[Object(o.jsxs)("div",{className:"home-overlay",children:[Object(o.jsxs)("div",{className:"home-widget anniverse",children:[!g&&Object(o.jsx)("div",{className:"home-noPartner",children:"You need to have a partner to access this widget"}),_?Object(o.jsxs)("div",{className:"home-event-div",onMouseOut:Ze,onMouseOver:function(){return Ke("special")},children:[Object(o.jsx)(y.a,{id:"home-delete-specialWidget",onClick:function(){return Xe("special")},children:Object(o.jsx)(I.a,{})}),Object(o.jsxs)("div",{className:"home-event-title",children:[Object(o.jsx)("h3",{children:"Up Coming Event:"}),Object(o.jsx)("br",{}),Object(o.jsx)("h1",{children:xe})]}),Object(o.jsx)("div",{className:"home-event-day",children:Object(o.jsxs)("h1",{children:[ke," days left"]})})]}):Object(o.jsxs)("div",{className:"home-noWidget",children:[Object(o.jsx)(y.a,{id:"home-add-widget",onClick:function(){return He("special")},onMouseOver:function(){return Ye("special")},onMouseOut:function(){return Ve("special")},children:Object(o.jsx)(F.a,{fontSize:"large"})}),Object(o.jsx)("div",{className:"home-add-hover",id:"hover-special",children:"Add this widget to get to know up coming special events"})]})]}),Object(o.jsxs)("div",{className:"home-widget days",children:[!g&&Object(o.jsx)("div",{className:"home-noPartner",children:"You need to have a partner to access this widget"}),E?Object(o.jsxs)("div",{className:"home-totalDay-widget",onMouseOut:Ze,onMouseOver:function(){return Ke("day")},children:[Object(o.jsx)(y.a,{id:"home-delete-dayWidget",onClick:function(){return Xe("day")},children:Object(o.jsx)(I.a,{})}),Object(o.jsxs)("h1",{children:[te," DAYS"]})]}):Object(o.jsxs)("div",{className:"home-noWidget",id:"noDayWidget",children:[Object(o.jsx)(y.a,{id:"home-add-widget",onClick:function(){return He("day")},onMouseOver:function(){return Ye("day")},onMouseOut:function(){return Ve("day")},children:Object(o.jsx)(F.a,{fontSize:"large"})}),Object(o.jsx)("div",{className:"home-add-hover",id:"hover-day",children:"Add this widget to get to know total days together"})]}),X&&Object(o.jsxs)("div",{className:"home-setDate",children:[Object(o.jsx)("div",{className:"home-setDate-title",children:Object(o.jsx)("h2",{children:"Please set the date of you with your partner"})}),Object(o.jsxs)("form",{onSubmit:function(e){return Ge.apply(this,arguments)},ref:qe,children:[Object(o.jsx)(R.a,{utils:T.a,children:Object(o.jsx)(M.a,{margin:"normal",id:"dateOfRelation",label:"Date of Relationship",name:"dateOfRelation",format:"MM/dd/yyyy",value:Te,onChange:function(e){Le(e)},KeyboardButtonProps:{"aria-label":"change date"}})}),Object(o.jsx)(s.a,{type:"submit",id:"home-submit-day",children:"SUBMIT"})]})]})]}),Object(o.jsxs)("div",{className:"home-widget special",children:[!g&&Object(o.jsx)("div",{className:"home-noPartner",children:"You need to have a partner to access this widget"}),z?Object(o.jsxs)("div",{className:"home-dob-div",onMouseOut:Ze,onMouseOver:function(){return Ke("bday")},children:[Object(o.jsx)(y.a,{id:"home-delete-bdayWidget",onClick:function(){return Xe("bday")},children:Object(o.jsx)(I.a,{})}),Object(o.jsxs)("div",{className:"home-bday-div you",children:[Object(o.jsx)("div",{className:"home-bday-name",children:Object(o.jsx)("h1",{children:a.nickname})}),Object(o.jsx)("div",{className:"home-bday-border",children:Object(o.jsxs)("div",{className:"home-bday-calander",children:[Object(o.jsx)("h2",{style:{borderBottom:"1px solid white"},children:re}),Object(o.jsx)("br",{}),Object(o.jsx)("br",{}),Object(o.jsx)("br",{}),Object(o.jsxs)("h1",{children:[be," days left"]})]})})]}),Object(o.jsxs)("div",{className:"home-bday-div partner",children:[Object(o.jsx)("div",{className:"home-bday-name",children:Object(o.jsx)("h1",{children:l.nickname})}),Object(o.jsx)("div",{className:"home-bday-border",children:Object(o.jsxs)("div",{className:"home-bday-calander",children:[Object(o.jsx)("h2",{style:{borderBottom:"1px solid white"},children:le}),Object(o.jsx)("br",{}),Object(o.jsx)("br",{}),Object(o.jsx)("br",{}),Object(o.jsxs)("h1",{children:[Oe," days left"]})]})})]})]}):Object(o.jsxs)("div",{className:"home-noWidget",children:[Object(o.jsx)(y.a,{id:"home-add-widget",onClick:function(){return He("bday")},onMouseOver:function(){return Ye("bday")},onMouseOut:function(){return Ve("bday")},children:Object(o.jsx)(F.a,{fontSize:"large"})}),Object(o.jsx)("div",{className:"home-add-hover",id:"hover-bday",children:"Add this widget to get to know each other birthdays"})]})]})]}),Object(o.jsx)("div",{className:"foreground",id:"foreground"})]})]})}var A=n(395),_=n(387),q=n(396),W=n(390),U=n(392),z=n(397),Y=(n(248),n(169)),V=n.n(Y),H=[{value:"male",label:"male"},{value:"female",label:"female"}],J=Object(_.a)((function(e){return{formControl:{marginTop:20,minWidth:"90%"}}}));function G(){var e=Object(f.useState)(""),t=Object(m.a)(e,2),n=t[0],a=t[1],c=Object(f.useState)(""),r=Object(m.a)(c,2),i=r[0],l=r[1],d=Object(f.useState)(),j=Object(m.a)(d,2),h=j[0],O=j[1],g=Object(f.useState)(!1),x=Object(m.a)(g,2),w=x[0],I=x[1],k=Object(f.useState)(new Date),N=Object(m.a)(k,2),C=N[0],S=N[1],B=Object(f.useState)("male"),E=Object(m.a)(B,2),D=E[0],P=E[1],F=Object(f.useState)(!1),L=Object(m.a)(F,2),_=(L[0],L[1],Object(f.useState)()),Y=Object(m.a)(_,2),G=Y[0],K=Y[1],Z=Object(f.useState)(),X=Object(m.a)(Z,2),$=X[0],Q=X[1],ee=Object(f.useRef)(),te=J();if(Object(f.useEffect)((function(){var e=new AbortController;return p.a.get("/auth/isLoggedIn").then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){!1===e.isLoggedIn?window.open("/login","_self"):e.user.nickname&&(a(e.user.nickname),S(e.user.dateOfBirth),P(e.user.gender),l(e.user.bio),null!==e.user.partner&&(K(e.user.partner),e.user.dateOfRelationship&&Q(e.user.dateOfRelationship)))})),function(){e.abort()}}),[]),Object(f.useEffect)((function(){var e=new AbortController;return p()({method:"get",url:"/gridFs/checkExists",headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){!0===e&&(document.getElementById("overlay").style.visibility="hidden")})),function(){e.abort()}}),[]),w){var ne=new FileReader;ne.onload=function(e){null!==e.target.result&&document.getElementById("avatarImg").setAttribute("src",e.target.result)},ne.readAsDataURL(h)}function ae(){return(ae=Object(b.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w&&p.a.get("/gridFs/deleteImg"),t.preventDefault(),n=new FormData(ee.current),G&&n.append("partner",G),e.next=6,p()({method:"post",url:"/user/info",data:n,headers:{"Content-Type":"multipart/form-data"}});case 6:window.location.href="/";case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.jsx)("div",{className:"infoForm",id:"infoForm",children:Object(o.jsxs)("form",{onSubmit:function(e){return ae.apply(this,arguments)},ref:ee,children:[Object(o.jsxs)("div",{id:"avatar",children:[Object(o.jsx)(v.a,{id:"overlay"}),Object(o.jsx)("img",{src:w?"":"/gridFs/getProfile",id:"avatarImg"})]}),Object(o.jsxs)("div",{className:"fileIpt",children:[Object(o.jsx)("input",{type:"file",name:"file",id:"file",onChange:function(e){var t=e.target.files[0];void 0!==t&&(document.getElementById("overlay").style.visibility="hidden",O(t),I(!0))}}),Object(o.jsx)(y.a,{id:"uploadBtn",onClick:function(){document.getElementById("file").click()},children:Object(o.jsx)(V.a,{})})]}),Object(o.jsx)("br",{}),Object(o.jsxs)("div",{className:"infoDiv",children:[Object(o.jsx)(A.a,{id:"nickname",className:"inputFields",label:"Nickname",variant:"outlined",name:"nickname",value:n,onChange:function(e){a(e.target.value)}}),Object(o.jsx)("br",{}),Object(o.jsxs)(W.a,{variant:"outlined",className:te.formControl,children:[Object(o.jsx)(q.a,{id:"demo-simple-select-outlined-label",children:"Gender"}),Object(o.jsx)(U.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:D,onChange:function(e){P(e.target.value)},label:"Gender",name:"gender",children:H.map((function(e){return Object(o.jsx)(z.a,{value:e.value,children:e.label},e.value)}))})]}),Object(o.jsx)("br",{}),Object(o.jsx)(R.a,{utils:T.a,style:{marginLeft:"10px"},children:Object(o.jsx)(M.a,{margin:"normal",id:"dateOfBirth",label:"Date of birth (mm/dd/yyyy)",name:"dateOfBirth",format:"MM/dd/yyyy",value:C,onChange:function(e){S(e)},KeyboardButtonProps:{"aria-label":"change date"}})}),$&&Object(o.jsx)(R.a,{utils:T.a,children:Object(o.jsx)(M.a,{margin:"normal",id:"dateOfRelation",label:"Date of relationship",name:"dateOfRelationship",format:"MM/dd/yyyy",value:$,onChange:function(e){Q(e)},KeyboardButtonProps:{"aria-label":"change date"}})}),Object(o.jsx)("br",{}),Object(o.jsx)(A.a,{id:"bio",label:"Bio",variant:"outlined",name:"bio",className:"inputFields",value:i,onChange:function(e){l(e.target.value)}}),Object(o.jsx)("br",{}),Object(o.jsx)(s.a,{type:"submit",id:"submitInfo",children:"submit"})]})]})})}var K=n(49),Z=n(78),X=n.n(Z),$=(n(280),n(170)),Q=n.n($);function ee(e){var t=e.handleSendMsg;return Object(o.jsx)("div",{className:"foot",children:Object(o.jsxs)("form",{onSubmit:t,className:"input-form",children:[Object(o.jsx)("input",{type:"text",className:"msg",placeholder:"Type a message...",id:"chat"}),Object(o.jsx)(y.a,{type:"submit",id:"sendIcon",children:Object(o.jsx)(Q.a,{})})]})})}n(281),n(282);var te=n(100),ne=n.n(te),ae=n(101),ce=n.n(ae);function re(e){e.toggleBackHome;var t=e.partnerInfo,n=e.partnerStatus,a=e.toggleVideoCall,c=(e.callAccepted,e.setBackgroundUrl,Object(f.useState)(!1)),r=Object(m.a)(c,2),i=r[0],s=r[1],l=Object(f.useState)(!1),d=Object(m.a)(l,2),j=d[0],h=d[1],O=Object(f.useState)(!1),v=Object(m.a)(O,2),g=v[0],x=v[1];Object(f.useRef)();function w(){return(w=Object(b.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("/chat/deleteBackground");case 2:return(n=new FormData).append("file",t.target.files[0]),e.next=6,p()({method:"post",url:"/chat/uploadChatImg",data:n,headers:{"Content-Type":"multipart/form-data"}});case 6:window.location.reload();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.useEffect)((function(){var e=new AbortController;return t&&s(!0),function(){e.abort()}}),[t]),n&&t&&n.map((function(e){e===t._id&&h(!0)})),Object(o.jsxs)("div",{className:"chatNav-div",children:[j&&Object(o.jsx)("h1",{children:"ONLINE"}),g&&Object(o.jsx)("div",{className:"chatNav-moreOption",children:Object(o.jsxs)("div",{className:"chatNav-changeBackground",onClick:function(){return document.getElementById("chatNav-file").click()},children:[Object(o.jsx)(E.a,{}),Object(o.jsx)("input",{type:"file",name:"file",hidden:!0,id:"chatNav-file",onChange:function(e){return w.apply(this,arguments)}})]})}),Object(o.jsxs)("div",{className:"head",children:[Object(o.jsxs)("div",{className:"user",children:[Object(o.jsx)("div",{className:"avatar",id:"avatarStatus",children:Object(o.jsx)("img",{src:"/gridFs/getPartnerProfile"})}),i&&Object(o.jsx)("div",{className:"name",children:t.nickname})]}),Object(o.jsxs)("ul",{id:"bar_tool",children:[Object(o.jsx)(y.a,{id:"iconBtn",onClick:a,children:Object(o.jsx)("span",{className:"alink",children:Object(o.jsx)(ne.a,{id:"contact"})})}),Object(o.jsx)(y.a,{id:"iconBtn",onClick:function(){return x(!g)},children:Object(o.jsx)("span",{className:"alink",children:Object(o.jsx)(ce.a,{id:"contact"})})})]})]})]})}n(283);function ie(e){var t=e.textInfo,n=e.user;return t&&t.userId===n._id?Object(o.jsx)("div",{className:"bubble-div righter",children:Object(o.jsx)("div",{className:"context",children:Object(o.jsx)("p",{children:t&&t.text})})}):Object(o.jsxs)("div",{className:"bubble-div lefter",children:[Object(o.jsx)("div",{className:"img-div",children:Object(o.jsx)("img",{src:"/gridFs/getPartnerProfile"})}),Object(o.jsx)("div",{className:"context",children:Object(o.jsx)("p",{children:t&&t.text})})]})}n(284);var se,oe,le=n(117),de=n.n(le),ue=Object(f.createContext)(),je=!1,be=!1,he=function(e){var t=e.children,n=Object(f.useState)(!1),a=Object(m.a)(n,2),c=a[0],r=a[1],i=Object(f.useState)(!1),s=Object(m.a)(i,2),l=s[0],d=s[1],j=Object(f.useState)(),h=Object(m.a)(j,2),O=h[0],p=h[1],v=Object(f.useState)({}),g=Object(m.a)(v,2),x=g[0],y=g[1],w=Object(f.useState)(""),I=Object(m.a)(w,2),k=I[0],N=I[1],C=Object(f.useState)(""),S=Object(m.a)(C,2),B=S[0],E=S[1],D=Object(f.useState)([]),P=Object(m.a)(D,2),F=P[0],R=P[1],M=Object(f.useState)(),T=Object(m.a)(M,2),L=(T[0],T[1],Object(f.useState)(!1)),A=Object(m.a)(L,2),_=A[0],q=A[1],W=Object(f.useState)(!1),U=Object(m.a)(W,2),z=U[0],Y=U[1],V=Object(f.useState)(!0),H=Object(m.a)(V,2),J=H[0],G=(H[1],Object(f.useState)()),K=Object(m.a)(G,2),X=K[0],$=(K[1],Object(f.useRef)()),Q=Object(f.useRef)(),ee=Object(f.useRef)();Object(f.useEffect)((function(){(se=Object(Z.io)("localhost:5000")).on("chatMsg",(function(e){R(e)})),se.on("startCalling",(function(e){ce()})),se.on("start",(function(e){q(!0)})),se.on("no",(function(e){Y(!0),alert("your partner is not online!")}))}),[]),Object(f.useEffect)((function(){if(!_)return null;se.on("returnDiv",(function(e){document.getElementById("chat-body").style.marginRight="auto",document.getElementById("chat-body").style.marginLeft="auto",document.getElementById("video-div").style.visibility="hidden"})),se.on("calluser",function(){var e=Object(b.a)(u.a.mark((function e(t){var n,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.from,a=t.name,c=t.signal,y({isReceivingCall:!0,from:n,name:a,signal:c});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),se.on("moveDiv",(function(e){document.getElementById("chat-body").style.marginRight="auto",document.getElementById("chat-body").style.marginLeft="10px",document.getElementById("video-div").style.visibility="visible"})),se.on("dc",(function(e){re()}))}),[_]);var te=!0,ne=!0,ae=function(){var e=Object(b.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){p(e),t=e,$.current.srcObject=e}));case 2:be=!0,r(!0),(n=new de.a({initiator:!1,trickle:!1,stream:t})).on("signal",(function(e){se.emit("answercall",{signal:e,to:x.from})})),n.on("stream",(function(e){console.log("this is the remote stream: "+e),Q.current.srcObject=e})),n.signal(x.signal),ee.current=n;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=Object(b.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){p(e),t=e,$.current.srcObject=e}));case 4:je=!0,(n=new de.a({initiator:!0,trickle:!1,stream:t})).on("signal",(function(e){se.emit("calluser",{signalData:e,name:oe})})),n.on("stream",(function(e){Q.current.srcObject=e})),se.on("callaccepted",(function(e){console.log("call accepted: "+e),r(!0),n.signal(e)})),ee.current=n;case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){d(!0),je&&(document.getElementById("chat-body").style.marginRight="auto",document.getElementById("chat-body").style.marginLeft="auto",document.getElementById("video-div").style.visibility="hidden"),ee.current.destroy(),window.location.reload()};return Object(o.jsx)(ue.Provider,{value:{call:x,callAccepted:c,myVideo:$,newMessage:F,sendMsg:function(e,t){se.emit("sendMsg",{msg:e,userId:k,nickname:t,roomId:B})},joinRoom:function(e,t,n){se.emit("join",{userId:t,roomId:e}),N(t),E(e),oe=n},userVideo:Q,stream:O,name:oe,callEnded:l,callUser:ce,leaveCall:re,answerCall:ae,users:X,isOnline:J,startCall:function(){se.emit("calling")},muteAudio:function(){te=!te,O.getAudioTracks()[0].enabled=te},muteVideo:function(){ne=!ne,O.getVideoTracks()[0].enabled=ne},declineCall:function(){d(!0),je&&(document.getElementById("chat-body").style.marginRight="auto",document.getElementById("chat-body").style.marginLeft="auto",document.getElementById("video-div").style.visibility="hidden"),q(!1),window.location.reload()},isCaller:je,isAnswered:be},children:t})},me=n(171),fe=n.n(me);function Oe(e){var t=Object(f.useContext)(ue),n=t.answerCall,a=t.call,c=t.declineCall;function r(){return(r=Object(b.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.getElementById("chat-body").style.marginRight="auto",document.getElementById("chat-body").style.marginLeft="10px",document.getElementById("video-div").style.visibility="visible",n();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.jsxs)("div",{className:"respond",children:[Object(o.jsx)(v.a,{src:"/gridFs/getPartnerProfile",id:"caller"}),Object(o.jsx)("div",{className:"description",children:Object(o.jsxs)("h3",{children:[a.name," wants to call you"]})}),Object(o.jsxs)("div",{className:"choice",children:[Object(o.jsx)(y.a,{id:"choice-btn",onClick:function(){return r.apply(this,arguments)},children:Object(o.jsx)(fe.a,{})}),Object(o.jsx)(y.a,{id:"choice-canc",onClick:c,children:Object(o.jsx)(I.a,{})})]})]})}n(318);var pe=n(172),ve=n.n(pe),ge=n(175),xe=n.n(ge),ye=n(173),we=n.n(ye),Ie=n(174),ke=n.n(Ie);function Ne(){var e=Object(f.useContext)(ue),t=(e.name,e.callAccepted),n=e.myVideo,a=e.userVideo,c=e.callEnded,r=(e.stream,e.callUser,e.leaveCall),i=(e.initializeVideo,e.muteAudio),s=e.muteVideo,l=e.declineCall,d=e.isAnswered,u=Object(f.useState)(!1),j=Object(m.a)(u,2),b=j[0],h=j[1],O=Object(f.useState)(!0),p=Object(m.a)(O,2),v=p[0],g=p[1];return console.log(d),Object(o.jsxs)("div",{className:"video-div",id:"video-div",children:[Object(o.jsx)("div",{className:"vid-call",children:Object(o.jsx)("video",{playsInline:!0,muted:!0,ref:n,autoPlay:!0})}),t&&!c&&Object(o.jsx)("div",{className:"vid-call1",children:Object(o.jsx)("video",{playsInline:!0,muted:!0,ref:a,autoPlay:!0})}),Object(o.jsxs)("div",{className:"option-div",children:[Object(o.jsx)(y.a,{onClick:function(){g(!v),s()},className:"option-btn",id:"display",children:v?Object(o.jsx)(ne.a,{}):Object(o.jsx)(ve.a,{})}),Object(o.jsx)(y.a,{onClick:d?r:l,className:"option-btn",id:"end",children:Object(o.jsx)(we.a,{fontSize:"inherit"})}),Object(o.jsx)(y.a,{onClick:function(){h(!b),i()},className:"option-btn",children:b?Object(o.jsx)(ke.a,{}):Object(o.jsx)(xe.a,{})})]})]})}function Ce(e){var t=Object(f.useState)(),n=Object(m.a)(t,2),a=n[0],c=n[1],r=Object(f.useState)(),i=Object(m.a)(r,2),s=i[0],l=i[1],d=Object(f.useState)(),j=Object(m.a)(d,2),O=j[0],v=j[1],g=Object(f.useState)(""),x=Object(m.a)(g,2),y=(x[0],x[1]),w=Object(f.useState)(),I=Object(m.a)(w,2),k=I[0],N=I[1],C=Object(f.useState)([]),S=Object(m.a)(C,2),B=S[0],E=S[1],P=Object(f.useState)([]),F=Object(m.a)(P,2),R=F[0],M=F[1],T=Object(f.useState)(),L=Object(m.a)(T,2),A=L[0],_=(L[1],Object(f.useState)(!1)),q=Object(m.a)(_,2),W=q[0],U=q[1],z=Object(f.useState)(-1),Y=Object(m.a)(z,2),V=Y[0],H=(Y[1],Object(f.useContext)(ue)),J=H.joinRoom,G=H.sendMsg,Z=H.newMessage,X=H.call,$=H.callAccepted,Q=H.startCall;function te(){return(te=Object(b.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.useEffect)((function(){var e=new AbortController;return p.a.get("/auth/isLoggedIn").then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){if(e.isLoggedIn){p.a.get("/chat/checkExist").then(e.data).catch((function(e){return console.log(e)})).then((function(e){e.data?(document.getElementById("msgBox").style.backgroundImage='url("/chat/getChatBackground")',document.getElementById("msgBox").style.backgroundSize="cover"):document.getElementById("msgBox").style.backgroundImage='url("https://wallpapercave.com/wp/wp4779329.png")'}));var t=e.user._id,n=(e.user.partner,e.user.nickname);M(e.partnerInfo),null!==e.user.partner&&(U(!0),p()({method:"get",url:"/user/getRoomId",headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){E(e.chatInfo.chats.reverse().map((function(e){return e})));var a=e.roomInfo._id;v(a),n&&J(a,t,n)}))),l(e.user._id),c(Object(h.a)({},e.user)),N(e.user.nickname)}})),function(){e.abort()}}),[]),Object(f.useEffect)((function(){E((function(e){return[].concat(Object(K.a)(e),[Z])}))}),[Z]),Object(f.useEffect)((function(){-1===V&&document.getElementById("msgBox").scrollTo(0,document.getElementById("msgBox").scrollHeight)}),[B]),Object(o.jsxs)("div",{className:"chat-div",children:[Object(o.jsx)(D,{havePartner:W}),X.isReceivingCall&&!$&&Object(o.jsx)(Oe,{}),Object(o.jsx)(Ne,{}),Object(o.jsx)("div",{className:"chat-container",children:Object(o.jsxs)("div",{className:"chat-body",id:"chat-body",children:[Object(o.jsx)(re,{toggleBackHome:function(){window.open("/","_self")},partnerInfo:R,partnerStatus:A,toggleVideoCall:function(){return te.apply(this,arguments)}}),Object(o.jsx)("div",{className:"chat-messageBox-div",id:"msgBox",children:Object(o.jsx)("div",{className:"chat-messageBox",children:B&&a&&B.map((function(e,t){return Object(o.jsx)(ie,{textInfo:e,user:a},t)}))})}),Object(o.jsx)(ee,{handleSendMsg:function(e){var t=document.getElementById("chat").value;e.preventDefault(),t.length>0&&O?(G(t,s,k,O),y("")):console.log("You cant send anything"),document.getElementById("chat").value=null}})]})})]})}var Se=n(176),Be=n.n(Se),Ee=(n(337),n(182)),De=n.n(Ee),Pe=n(181),Fe=n.n(Pe),Re=n(102),Me=n.n(Re),Te=n(178),Le=n.n(Te),Ae=n(177),_e=n.n(Ae);function qe(e){var t=e.handleChooseMovie,n=e.socket,a=Object(f.useState)([]),c=Object(m.a)(a,2),r=c[0],i=c[1],l=Object(f.useState)(!1),d=Object(m.a)(l,2),j=d[0],h=d[1];function O(){return(O=Object(b.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("videoId",t),e.next=4,p()({method:"post",url:"/videoFs/deleteVideo",data:a,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){console.log(e),e&&(i((function(e){return e.filter((function(e){return e._id!==t}))})),n&&n.emit("deletedVideo"))}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.useEffect)((function(){p.a.get("/videoFs/getAllVideos").then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);i(t)}))}),[]),Object(o.jsxs)("div",{className:"video-file",id:"video-file",children:[Object(o.jsx)("div",{className:"video-scroll",children:r.map((function(e){return Object(o.jsxs)("div",{className:"video-list-div",children:[Object(o.jsx)(s.a,{variant:"outlined",onClick:function(){return t(e.filename)},id:"list",children:e.aliases},e._id),Object(o.jsx)("button",{id:"video-delete",onClick:function(){return function(e){return O.apply(this,arguments)}(e._id)},children:"x"})]})}))}),Object(o.jsx)(y.a,{size:"small",id:"drop-down",onClick:function(){var e=!j;document.getElementById("video-file").style.top=e?0:"-68px",h(!j)},children:j?Object(o.jsx)(_e.a,{}):Object(o.jsx)(Le.a,{})})]})}var We=n(179),Ue=n.n(We),ze=n(103),Ye=n.n(ze);function Ve(e){var t=Object(f.useState)(!1),n=Object(m.a)(t,2),a=n[0],c=n[1],r=Object(f.useState)(!1),i=Object(m.a)(r,2),l=i[0],d=i[1],j=Object(f.useRef)();function h(){return(h=Object(b.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==document.getElementById("video").value){e.next=3;break}return e.abrupt("return");case 3:return d(!0),n=new FormData(j.current),e.next=7,p()({method:"post",url:"/videoFs/upload",data:n,headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var t=e.loaded/e.total*100;document.getElementById("uploadFileProgress").style.width=t+"%",100===t&&window.location.reload()}});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.jsxs)("div",{className:"upload-file",id:"upload-file",children:[Object(o.jsxs)("form",{onSubmit:function(e){return h.apply(this,arguments)},ref:j,children:[Object(o.jsx)(y.a,{size:"medium",onClick:function(){return document.getElementById("video").click()},style:{color:"white"},children:Object(o.jsx)(Ue.a,{})}),Object(o.jsx)("input",{type:"file",name:"video",id:"video",hidden:!0,onChange:function(e){document.getElementById("file-name").textContent=e.target.files[0].name}}),Object(o.jsx)(s.a,{variant:"contained",color:"default",type:"submit",children:"Upload"})]}),Object(o.jsx)("p",{id:"file-name",style:{color:"rgb(56, 245, 71)"}}),l&&Object(o.jsx)("div",{className:"uploadProgress",children:Object(o.jsx)("div",{className:"progressBar",id:"uploadFileProgress"})}),Object(o.jsx)(y.a,{size:"small",id:"openUploadDiv",onClick:function(){var e=!a;document.getElementById("upload-file").style.marginLeft=e?0:"-380px",c(!a)},children:a?Object(o.jsx)(Me.a,{}):Object(o.jsx)(Ye.a,{})})]})}var He,Je=n(185),Ge=n.n(Je),Ke=n(183),Ze=n.n(Ke),Xe=n(184),$e=n.n(Xe),Qe=n(187),et=n.n(Qe),tt=n(186),nt=n.n(tt),at=n(180),ct=n.n(at),rt=n(120);function it(){var e=Object(rt.b)(),t=Object(f.useState)(!1),n=Object(m.a)(t,2),a=n[0],c=n[1],r=Object(f.useState)(!1),i=Object(m.a)(r,2),l=i[0],d=i[1],j=Object(f.useState)(!1),h=Object(m.a)(j,2),O=h[0],v=h[1],g=Object(f.useState)(),x=Object(m.a)(g,2),w=x[0],I=x[1],k=Object(f.useState)(!0),N=Object(m.a)(k,2),C=N[0],S=N[1],B=Object(f.useState)(.5),E=Object(m.a)(B,2),D=E[0],P=E[1],F=Object(f.useState)(!1),R=Object(m.a)(F,2),M=R[0],T=R[1],L=Object(f.useState)(!1),A=Object(m.a)(L,2),_=A[0],q=A[1],W=Object(f.useState)(!1),U=Object(m.a)(W,2),z=U[0],Y=U[1],V=Object(f.useRef)(),H=Object(f.useRef)(""),J=Object(f.useRef)(!1),G=Object(f.useRef)(!0);function K(){return(K=Object(b.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(!0),n="/videoFs/choose/"+t,He.emit("onlineUrl",n);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.useEffect)(Object(b.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new AbortController,He=X()("localhost:5000"),!G.current){e.next=6;break}return e.next=5,p.a.get("/user/getRoomId").then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){He.emit("join",e.roomInfo._id)}));case 5:G.current=!1;case 6:return He.on("changeState",(function(e){d(e)})),He.on("refreshPage",(function(e){window.location.reload()})),He.on("update",(function(e){if(""===H.current)return H.current=e.url,c(!0),J.current=!0,void S(!1);J.current&&e.time>V.current.getCurrentTime()&&V.current.getCurrentTime()<e.time-1&&V.current.seekTo(String(e.time),"seconds")})),He.on("updateProgress",(function(e){V.current.seekTo(e,"seconds")})),He.on("onlineUrl",(function(e){""!==e?(c(!0),H.current=e,I(e),document.getElementById("url").value=""):document.getElementById("url").value=""})),e.abrupt("return",(function(){t.abort()}));case 12:case"end":return e.stop()}}),e)}))),[]),Object(o.jsxs)("div",{className:"cinema-div",children:[Object(o.jsx)(qe,{handleChooseMovie:function(e){return K.apply(this,arguments)},socket:He}),Object(o.jsx)(Ve,{}),Object(o.jsxs)("div",{className:"submit-url",id:"submitUrl",children:[Object(o.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=document.getElementById("url").value;He.emit("onlineUrl",t)},children:[Object(o.jsx)("input",{type:"text",id:"url",placeholder:"enter url"}),Object(o.jsx)(s.a,{type:"submit",variant:"outlined",id:"submit-url-btn",children:" submit"})]}),Object(o.jsx)(y.a,{size:"small",id:"handleUrlDiv",onClick:function(){var e=!O;document.getElementById("submitUrl").style.marginLeft=e?0:"-380px",v(!O)},children:O?Object(o.jsx)(Me.a,{}):Object(o.jsx)(Ye.a,{})})]}),Object(o.jsx)(s.a,{variant:"outlined",color:"black",href:"/",id:"homeBtn",children:Object(o.jsx)(ct.a,{})}),Object(o.jsx)(rt.a,{handle:e,children:Object(o.jsxs)("div",{className:"video-player",id:"video-player",children:[C&&a&&Object(o.jsx)("div",{className:"no-video",children:Object(o.jsx)("h1",{children:"Loading...."})}),a?Object(o.jsx)(Be.a,{ref:V,playing:l,height:"100%",width:"100%",url:H.current,volume:D,onProgress:function(){He.emit("keepUpdate",{time:V.current.getCurrentTime(),url:w});var e=document.getElementById("progress-point"),t=V.current.getCurrentTime()/(V.current.getDuration()/100);e.style.left=t+"%"},onReady:function(){return S(!1)},onError:function(){return c(!1)}}):Object(o.jsx)("div",{className:"no-video",children:Object(o.jsx)("h2",{children:"No Video"})}),Object(o.jsxs)("div",{style:{display:"flex"},className:"progress-bar-div",id:"controls",children:[Object(o.jsx)(y.a,{onClick:function(){He.emit("changeVideoState",l)},id:"control-btn",style:{color:"black"},children:l?Object(o.jsx)(Fe.a,{}):Object(o.jsx)(De.a,{})}),Object(o.jsx)(y.a,{onClick:function(){!M?(P(0),document.getElementById("volume").value=0):(P(.5),document.getElementById("volume").value=50),T(!M)},id:"control-vlm",style:{color:"black"},children:M?Object(o.jsx)(Ze.a,{}):_?Object(o.jsx)($e.a,{}):Object(o.jsx)(Ge.a,{})}),Object(o.jsx)("input",{type:"range",min:"0",max:"100",id:"volume",onChange:function(){var e=document.getElementById("volume").value,t=parseFloat(e/100);T(0===t),q(e>50),P(t)}}),Object(o.jsx)("div",{id:"progress-bar",className:"progress-bar status",onClick:a?function(e){var t=document.getElementById("progress-bar"),n=e.nativeEvent.offsetX/t.offsetWidth*V.current.getDuration();He.emit("changeProgress",n),d(!0)}:"",children:Object(o.jsx)("div",{id:"progress-point",className:"progress-point"})}),Object(o.jsx)(y.a,{onClick:function(){var t=!z,n=document.getElementById("controls");t?(e.enter(),n.style.bottom="-150px",document.getElementById("progress-point").style.background="white",document.getElementById("control-btn").style.color="white",document.getElementById("control-vlm").style.color="white",document.getElementById("fullscreen-btn").style.color="white"):(e.exit(),n.style.bottom="-50px",document.getElementById("progress-point").style.background="black",document.getElementById("control-btn").style.color="black",document.getElementById("control-vlm").style.color="black",document.getElementById("fullscreen-btn").style.color="black"),Y(!z)},id:"fullscreen-btn",style:{color:"black"},children:z?Object(o.jsx)(nt.a,{}):Object(o.jsx)(et.a,{})})]})]})})]})}n(338),n(339);var st=n(189),ot=n.n(st),lt=n(168),dt=n(188),ut=n(191),jt=n.n(ut),bt=n(190),ht=n.n(bt),mt=function(e){var t=e.selected;return Object(o.jsxs)("div",{style:t?{left:"4px",top:"4px",position:"absolute",zIndex:"1"}:{display:"none"},children:[Object(o.jsx)("svg",{style:{fill:"white",position:"absolute"},width:"24px",height:"24px",children:Object(o.jsx)("circle",{cx:"12.5",cy:"12.2",r:"8.292"})}),Object(o.jsx)("svg",{style:{fill:"#06befa",position:"absolute"},width:"24px",height:"24px",children:Object(o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})})]})},ft={transition:"transform .135s cubic-bezier(0.0,0.0,0.2,1),opacity linear .15s"},Ot={transform:"translateZ(0px) scale3d(0.9, 0.9, 1)",transition:"transform .135s cubic-bezier(0.0,0.0,0.2,1),opacity linear .15s"},pt={backgroundColor:"#eee",cursor:"pointer",overflow:"hidden",position:"relative"},vt=function(e){var t=e.index,n=e.photo,a=e.margin,c=e.direction,r=e.top,i=e.left,s=e.selected,l=e.handleChooseNotToDeleteFile,d=e.handleChooseToDeleteFile,u=Object(f.useState)(s),j=Object(m.a)(u,2),b=j[0],O=j[1],p=200-n.height-n.height,v=(100-30/n.width*100)/100,g=(100-30/n.height*100)/100;Ot.transform="translateZ(0px) scale3d(".concat(v,", ").concat(g,", 1)"),"column"===c&&(pt.position="absolute",pt.left=i,pt.top=r);return Object(f.useEffect)((function(){O(s)}),[s]),Object(o.jsxs)("div",{style:Object(h.a)({margin:a,height:p,width:n.width},pt),className:b?"":"not-selected",children:[Object(o.jsx)(mt,{selected:!!b}),Object(o.jsx)("img",Object(h.a)(Object(h.a)({alt:n.title,style:b?Object(h.a)(Object(h.a)({},ft),Ot):Object(h.a)({},ft)},n),{},{onClick:function(e){O(!b),b?l(t):d(t)}})),Object(o.jsx)("style",{children:".not-selected:hover{outline:2px solid #06befa}"})]})};function gt(e){var t=e.setPost,n=e.handlePost,a=e.userInfo,c=(e.setIsPosting,e.setIsEditing,e.isEditing),r=e.postData,i=(e.setPostData,Object(f.useState)("")),l=Object(m.a)(i,2),d=l[0],j=l[1],h=Object(f.useState)([]),O=Object(m.a)(h,2),g=O[0],x=O[1],w=Object(f.useState)(),I=Object(m.a)(w,2),k=I[0],N=I[1],C=Object(f.useState)([]),S=Object(m.a)(C,2),B=S[0],E=S[1],D=Object(f.useState)([]),P=Object(m.a)(D,2),F=P[0],R=P[1],M=Object(f.useState)(!1),T=Object(m.a)(M,1)[0],L=Object(f.useRef)(),A=Object(f.useCallback)((function(e){var t=e.index,n=e.left,a=e.top,c=e.key,r=e.photo;return Object(o.jsx)(vt,{selected:!!T,margin:"2px",index:t,photo:r,left:n,top:a,handleChooseNotToDeleteFile:q,handleChooseToDeleteFile:_},c)}),[T,q,_]);function _(e){E((function(t){return[].concat(Object(K.a)(t),[e])}))}function q(e){E((function(t){return t.filter((function(t){return t!==e}))}))}function W(){return(W=Object(b.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(K.a)(B).sort(),n=Object(K.a)(g),a=t.length-1;case 3:if(!(a>=0)){e.next=11;break}if(!n[t[a]].fileId){e.next=7;break}return e.next=7,R((function(e){return[].concat(Object(K.a)(e),[n[t[a]].fileId])}));case 7:n.splice(t[a],1);case 8:a--,e.next=3;break;case 11:x(n),E([]);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return(U=Object(b.a)(u.a.mark((function e(){var a,i,s,o,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==d){e.next=3;break}return alert("Please enter some text"),e.abrupt("return");case 3:if(a=new FormData(L.current),!c){e.next=14;break}for(a.set("postId",r.post._id),a.set("text",d),a.set("feeling",k),i=0;i<F.length;i++)a.append("deletedFile[]",F[i]);for(s=0;s<g.length;s++)g[s].file?a.append("fileInput[]",g[s].file):a.append("fileInput[]",g[s].fileId);return e.next=12,p()({method:"post",url:"/post/editPost",data:a,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e.result?(t((function(t){for(var n=[],a=0;a<t.length;a++)t[a]._id===e.result.docs._id?n.push(e.result.docs):n.push(t[a]);return n})),n()):alert("Failed to edit post")})).catch((function(e){return console.log(e)}));case 12:e.next=19;break;case 14:for(o=new FormData(L.current),l=0;l<g.length;l++)o.append("fileInput[]",g[l].file);return e.next=18,p()({method:"post",url:"/post/createPost",data:o}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e?(alert("Memory Created!"),t((function(t){return[e].concat(Object(K.a)(t))}))):alert("Opps something went wrong")})).catch((function(e){return console.log(e)}));case 18:n();case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.useEffect)((function(){c&&(j(r.post.text),N(r.post.feeling),r.post.fileId&&x(r.post.fileId.map((function(e,t){return{src:r.url[t],width:1,height:1,fileId:e}}))))}),[]),Object(o.jsxs)("div",{className:"create-div",children:[Object(o.jsxs)("div",{className:"create-title",children:[Object(o.jsxs)("h3",{children:[c?"Edit":"Create"," Memory"]}),Object(o.jsx)(y.a,{onClick:n,id:"create-close-btn",children:Object(o.jsx)(ot.a,{})})]}),Object(o.jsxs)("form",{ref:L,children:[Object(o.jsxs)("div",{className:"create-feeling-div",children:[Object(o.jsx)("div",{className:"create-profile-pic",children:Object(o.jsx)(v.a,{src:"/gridFs/getProfile"})}),Object(o.jsx)("div",{className:"create-greeting",children:Object(o.jsxs)("p",{children:["Hi, ",a.nickname," how are you feeling today?"]})}),Object(o.jsx)("div",{className:"create-select",children:Object(o.jsxs)(lt.a,{value:k,onChange:function(e){return N(e.target.value)},id:"create-feeling",name:"feeling",children:[Object(o.jsx)("option",{"aria-label":"None",value:""}),Object(o.jsx)("option",{value:"happy",children:"Happy \ud83d\ude00 "}),Object(o.jsx)("option",{value:"sad",children:"Sad \u2639\ufe0f"}),Object(o.jsx)("option",{value:"surprise",children:"Surprised \ud83d\ude2e"}),Object(o.jsx)("option",{value:"meh",children:"Meh \ud83d\ude15"}),Object(o.jsx)("option",{value:"annoyed",children:"Annoyed \ud83d\ude44"}),Object(o.jsx)("option",{value:"sleepy",children:"Sleepy \ud83d\ude34"}),Object(o.jsx)("option",{value:"love",children:"Love \ud83e\udd70"}),Object(o.jsx)("option",{value:"touched",children:"Touched \ud83d\ude2d"}),Object(o.jsx)("option",{value:"shy",children:"Shy \ud83d\ude0c"}),Object(o.jsx)("option",{value:"amazed",children:"Amazed \ud83e\udd29"})]})})]}),Object(o.jsx)("div",{className:"create-textarea",children:Object(o.jsx)("textarea",{placeholder:"What's on your mind?",rows:"10",value:d,onChange:function(e){return j(e.target.value)},name:"text",id:"text"})}),Object(o.jsx)("div",{className:"create-gallery-div",children:Object(o.jsx)(dt.a,{photos:g,renderImage:A,id:"create-gallery"})}),Object(o.jsxs)("div",{className:"create-btn-div",children:[Object(o.jsx)(y.a,{id:"create-btn",onClick:function(){return document.getElementById("create-photo").click()},children:Object(o.jsx)(ht.a,{})}),Object(o.jsx)("input",{type:"file",hidden:!0,id:"create-photo",onChange:function(e){var t=e.target.files[0];if(t){/\.(gif|jpe?g|tiff?|png|webp|bmp)$/i.test(t.name)?x((function(e){return[].concat(Object(K.a)(e),[{src:URL.createObjectURL(t),file:t,width:1,height:1}])})):alert("only upload image files.")}}}),g.length>0&&Object(o.jsx)(y.a,{id:"create-btn",onClick:function(){return W.apply(this,arguments)},children:Object(o.jsx)(jt.a,{})})]}),Object(o.jsx)("div",{className:"create-post-div",children:Object(o.jsx)(s.a,{variant:"contained",id:"create-post-btn",onClick:function(){return U.apply(this,arguments)},children:"Post"})})]})]})}n(340);var xt=n(192),yt=n.n(xt);function wt(e){var t,n=e.post,a=e.userId,c=e.setIsEditing,r=e.setPostData,i=e.setIsPosting,s=e.setPost,l=Object(f.useState)(!1),d=Object(m.a)(l,2),j=d[0],h=d[1],O=Object(f.useState)([]),g=Object(m.a)(O,2),x=g[0],w=g[1],I={"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"};function k(){return(k=Object(b.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=new FormData).append("postId",n._id),n.fileId)for(a=0;a<n.fileId.length;a++)t.append("fileId[]",n.fileId[a]);return e.next=5,p()({method:"post",url:"/post/deletePost",data:t,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e.status?(s((function(e){return e.filter((function(e){return e._id!==n._id}))})),alert("Memory deleted")):alert("Opps something went wrong with the server!")}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.useEffect)(Object(b.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.fileId){e.next=5;break}return t=[],e.next=4,n.fileId.map((function(e){var n="/post/getPostImage/"+e;t.push(n)}));case 4:w(t);case 5:case"end":return e.stop()}}),e)}))),[n]),Object(o.jsxs)("div",{className:"post-div",children:[j&&Object(o.jsxs)("div",{className:"post-more-div",children:[Object(o.jsx)("div",{className:"post-more-option edit",onClick:function(){r({post:n,url:x}),c(!0),i(!0),h(!1)},children:"Edit Memory"}),Object(o.jsx)("div",{className:"post-more-option delete",onClick:function(){return k.apply(this,arguments)},children:"Delete Memory"})]}),Object(o.jsx)(y.a,{id:"post-more",onClick:function(){return h(!j)},children:Object(o.jsx)(ce.a,{fontSize:"medium"})}),Object(o.jsxs)("div",{className:"post-header",children:[a===n.userId?Object(o.jsx)(v.a,{src:"/gridFs/getProfile",id:"post-avatar"}):Object(o.jsx)(v.a,{src:"/gridFs/getPartnerProfile",id:"post-avatar"}),Object(o.jsxs)("div",{className:"post-desc",children:[Object(o.jsxs)("div",{className:"post-feeling",children:[Object(o.jsx)("h3",{children:n.nickname}),n.feeling&&Object(o.jsxs)("h3",{children:[" \xa0\u2022 \xa0is feeling ",n.feeling,"\xa0",{happy:"\ud83d\ude00",sad:"\u2639\ufe0f",surprise:"\ud83d\ude2e",meh:"\ud83d\ude15",annoyed:"\ud83d\ude44",sleepy:"\ud83d\ude34",love:"\ud83e\udd70",touched:"\ud83d\ude2d",shy:"\ud83d\ude0c",amazed:"\ud83e\udd29"}[n.feeling]]})]}),Object(o.jsx)("div",{className:"post-time",children:Object(o.jsx)("p",{children:function(e){var t=new Date(parseInt(Date.parse(e),10)),n=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),c=t.getFullYear();return n+" "+I[a]+" "+c}(n.timeOfCreation)})})]})]}),Object(o.jsx)("div",{className:"post-text",children:n.text}),Object(o.jsx)("div",{className:"post-images",children:n.fileId&&Object(o.jsx)(yt.a,{items:(t=n.fileId,t.map((function(e){return{original:"/post/getPostImage/"+e}}))),showFullscreenButton:!1,showPlayButton:!1,showThumbnails:!1,className:"post-gallery"})})]})}function It(){var e=Object(f.useState)(),t=Object(m.a)(e,2),n=t[0],a=t[1],c=Object(f.useState)(),r=Object(m.a)(c,2),i=(r[0],r[1]),l=Object(f.useState)(),d=Object(m.a)(l,2),u=d[0],j=d[1],b=Object(f.useState)(!1),h=Object(m.a)(b,2),O=h[0],v=h[1],g=Object(f.useState)(!1),x=Object(m.a)(g,2),y=x[0],w=x[1],I=Object(f.useState)([]),k=Object(m.a)(I,2),N=k[0],C=k[1],S=Object(f.useState)(!1),B=Object(m.a)(S,2),E=B[0],P=B[1];Object(f.useRef)();return Object(f.useEffect)((function(){p.a.get("/auth/isLoggedIn").then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e.isLoggedIn&&(null!==e.user.partner&&P(!0),a(e.user),i(e.partnerInfo),p()({method:"post",url:"/post/getPosts"}).then((function(e){return e.data})).catch((function(e){return console.log(e)})).then((function(e){e.success&&C(e.posts)})))}))}),[]),Object(o.jsxs)("div",{className:"memoryBook",children:[y&&Object(o.jsx)(gt,{setPostData:j,setPost:C,postData:u,handlePost:function(){w(!1),v(!1),j()},userInfo:n,setIsPosting:w,isEditing:O,setIsEditing:v}),Object(o.jsxs)("div",{className:"memoryBook-div",id:"memoryBook",style:{opacity:y||O?"0.3":"1"},children:[Object(o.jsx)(D,{havePartner:E}),Object(o.jsx)("div",{className:"postDiv",children:Object(o.jsxs)("div",{className:"post-option",children:[Object(o.jsx)("h3",{children:"Post Some Memorable Moment Here"}),Object(o.jsx)(s.a,{variant:"contained",id:"memory-create-post",onClick:function(){return w(!0)},children:"Create Memory \ud83e\udd0d"})]})}),N.map((function(e){return Object(o.jsx)(wt,{setPost:C,setPostData:j,setIsPosting:w,isEditing:O,setIsEditing:v,post:e,userId:n._id},e._id)}))]})]})}function kt(e){return Object(o.jsx)("main",{children:Object(o.jsxs)(i.c,{children:[Object(o.jsx)(i.a,{path:"/",exact:!0,component:L}),Object(o.jsx)(i.a,{path:"/login",exact:!0,component:l}),Object(o.jsx)(i.a,{path:"/userProfileForm",exact:!0,component:G}),Object(o.jsx)(i.a,{path:"/cinema",exact:!0,component:it}),Object(o.jsx)(i.a,{path:"/memoryBook",exact:!0,component:It}),Object(o.jsx)(he,{children:Object(o.jsx)(i.a,{path:"/chatRoom",exact:!0,component:Ce})})]})})}var Nt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,401)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};c.a.render(Object(o.jsx)(r.a,{children:Object(o.jsx)(kt,{})}),document.getElementById("root")),Nt()}},[[354,1,2]]]);
//# sourceMappingURL=main.afb76331.chunk.js.map