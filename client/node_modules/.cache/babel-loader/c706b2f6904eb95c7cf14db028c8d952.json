{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/PC/temp/couplove/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/PC/temp/couplove/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/PC/temp/couplove/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'../../css/memoryPost.css';import ReactAvatar from'@material-ui/core/Avatar';import MoreHorizIcon from'@material-ui/icons/MoreHoriz';import IconButton from'@material-ui/core/IconButton';import ImageGallery from\"react-image-gallery\";import{useEffect,useState}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function MemoryPost(props){var post=props.post,userId=props.userId,setIsEditing=props.setIsEditing,setPostData=props.setPostData,setIsPosting=props.setIsPosting,setPost=props.setPost;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),openMore=_useState2[0],setOpenMore=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),url=_useState4[0],setUrl=_useState4[1];var emojiMap={\"happy\":\"üòÄ\",\"sad\":\"‚òπÔ∏è\",\"surprise\":\"üòÆ\",\"meh\":\"üòï\",\"annoyed\":\"üôÑ\",\"sleepy\":\"üò¥\",\"love\":\"ü•∞\",\"touched\":\"üò≠\",\"shy\":\"üòå\",\"amazed\":\"ü§©\"};var monthMap={\"01\":\"January\",\"02\":\"February\",\"03\":\"March\",\"04\":\"April\",\"05\":\"May\",\"06\":\"June\",\"07\":\"July\",\"08\":\"August\",\"09\":\"September\",\"10\":\"October\",\"11\":\"November\",\"12\":\"December\"};useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var temp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!post.fileId){_context.next=5;break;}temp=[];_context.next=4;return post.fileId.map(function(id){var url=\"/post/getPostImage/\"+id;temp.push(url);});case 4:setUrl(temp);case 5:case\"end\":return _context.stop();}}},_callee);})),[post]);function constructGalleryUrls(fileId){return fileId.map(function(id){var url=\"/post/getPostImage/\"+id;return{original:url};});}function handleEdit(){setPostData({post:post,url:url});setIsEditing(true);setIsPosting(true);setOpenMore(false);}function deletePost(){return _deletePost.apply(this,arguments);}function _deletePost(){_deletePost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var formdata,i;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:formdata=new FormData();formdata.append('postId',post._id);if(post.fileId){for(i=0;i<post.fileId.length;i++){formdata.append('fileId[]',post.fileId[i]);}}_context2.next=5;return axios({method:'post',url:'/post/deletePost',data:formdata,headers:{'Content-Type':'multipart/form-data'}}).then(function(res){return res.data;}).catch(function(err){return console.log(err);}).then(function(res){if(res.status){setPost(function(prevData){return prevData.filter(function(posts){return posts._id!==post._id;});});alert(\"Memory deleted\");}else{alert(\"Opps something went wrong with the server!\");}});case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _deletePost.apply(this,arguments);}function formatDate(date){var today=new Date(parseInt(Date.parse(date),10));var dd=String(today.getDate()).padStart(2,'0');var mm=String(today.getMonth()+1).padStart(2,'0');//January is 0!\nvar yyyy=today.getFullYear();return dd+\" \"+monthMap[mm]+\" \"+yyyy;}return/*#__PURE__*/_jsxs(\"div\",{className:\"post-div\",children:[openMore&&/*#__PURE__*/_jsxs(\"div\",{className:\"post-more-div\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"post-more-option edit\",onClick:handleEdit,children:\"Edit Memory\"}),/*#__PURE__*/_jsx(\"div\",{className:\"post-more-option delete\",onClick:deletePost,children:\"Delete Memory\"})]}),/*#__PURE__*/_jsx(IconButton,{id:\"post-more\",onClick:function onClick(){return setOpenMore(!openMore);},children:/*#__PURE__*/_jsx(MoreHorizIcon,{fontSize:\"medium\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-header\",children:[userId===post.userId?/*#__PURE__*/_jsx(ReactAvatar,{src:\"/gridFs/getProfile\",id:\"post-avatar\"}):/*#__PURE__*/_jsx(ReactAvatar,{src:\"/gridFs/getPartnerProfile\",id:\"post-avatar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-desc\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post-feeling\",children:[/*#__PURE__*/_jsx(\"h3\",{children:post.nickname}),post.feeling&&/*#__PURE__*/_jsxs(\"h3\",{children:[\" \\xA0\\u2022 \\xA0is feeling \",post.feeling,\"\\xA0\",emojiMap[post.feeling]]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"post-time\",children:/*#__PURE__*/_jsx(\"p\",{children:formatDate(post.timeOfCreation)})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"post-text\",children:post.text}),/*#__PURE__*/_jsx(\"div\",{className:\"post-images\",children:post.fileId&&/*#__PURE__*/_jsx(ImageGallery,{items:constructGalleryUrls(post.fileId),showFullscreenButton:false,showPlayButton:false,showThumbnails:false,className:\"post-gallery\"})})]});}","map":{"version":3,"sources":["C:/Users/PC/temp/couplove/client/src/components/MemoryBook/MemoryPost.js"],"names":["ReactAvatar","MoreHorizIcon","IconButton","ImageGallery","useEffect","useState","axios","MemoryPost","props","post","userId","setIsEditing","setPostData","setIsPosting","setPost","openMore","setOpenMore","url","setUrl","emojiMap","monthMap","fileId","temp","map","id","push","constructGalleryUrls","original","handleEdit","deletePost","formdata","FormData","append","_id","i","length","method","data","headers","then","res","catch","err","console","log","status","prevData","filter","posts","alert","formatDate","date","today","Date","parseInt","parse","dd","String","getDate","padStart","mm","getMonth","yyyy","getFullYear","nickname","feeling","timeOfCreation","text"],"mappings":"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","sourcesContent":["import '../../css/memoryPost.css'\r\nimport ReactAvatar from '@material-ui/core/Avatar';\r\nimport MoreHorizIcon from '@material-ui/icons/MoreHoriz';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ImageGallery from \"react-image-gallery\";\r\nimport { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\n\r\n\r\nexport default function MemoryPost(props)\r\n{\r\n    const{post,userId,setIsEditing,setPostData,setIsPosting,setPost} = props\r\n    const [openMore,setOpenMore] = useState(false);\r\n    const [url,setUrl] = useState([]);\r\n\r\n    const emojiMap={\r\n        \"happy\": \"üòÄ\",\r\n        \"sad\": \"‚òπÔ∏è\",\r\n        \"surprise\": \"üòÆ\",\r\n        \"meh\": \"üòï\",\r\n        \"annoyed\": \"üôÑ\",\r\n        \"sleepy\": \"üò¥\",\r\n        \"love\": \"ü•∞\",\r\n        \"touched\": \"üò≠\",\r\n        \"shy\": \"üòå\",\r\n        \"amazed\": \"ü§©\"\r\n    }\r\n\r\n    const monthMap = {\r\n        \"01\": \"January\",\r\n        \"02\": \"February\",\r\n        \"03\": \"March\",\r\n        \"04\": \"April\",\r\n        \"05\": \"May\",\r\n        \"06\": \"June\",\r\n        \"07\": \"July\",\r\n        \"08\": \"August\",\r\n        \"09\": \"September\",\r\n        \"10\": \"October\",\r\n        \"11\": \"November\",\r\n        \"12\": \"December\",\r\n      }\r\n    \r\n\r\n    useEffect(async()=>{\r\n        if(post.fileId)\r\n        {\r\n        let temp =[];\r\n       await post.fileId.map(id=>{\r\n            let url = \"/post/getPostImage/\"+id;\r\n            temp.push(url);\r\n        })\r\n        setUrl(temp);\r\n        }\r\n    },[post])\r\n    \r\n    function constructGalleryUrls(fileId)\r\n    {\r\n        return fileId.map(id=>{\r\n            let url = \"/post/getPostImage/\"+id;\r\n            return {original:url};\r\n        })\r\n        \r\n    }\r\n    function handleEdit()\r\n    {\r\n        setPostData({post:post,url:url});\r\n        setIsEditing(true);\r\n        setIsPosting(true);\r\n        setOpenMore(false);\r\n    }\r\n    async function deletePost()\r\n    {\r\n        const formdata = new FormData();\r\n        formdata.append('postId',post._id);\r\n        if(post.fileId)\r\n        {\r\n            for(let i=0;i<post.fileId.length;i++)\r\n            {\r\n                formdata.append('fileId[]',post.fileId[i])\r\n            }\r\n        }\r\n        await axios({\r\n            method:'post',\r\n            url:'/post/deletePost',\r\n            data:formdata,\r\n            headers:{'Content-Type': 'multipart/form-data'}\r\n        })\r\n        .then(res=>res.data)\r\n        .catch(err=>console.log(err))\r\n        .then(res=>{\r\n            if(res.status)\r\n            {\r\n                setPost(prevData=>{\r\n                    return prevData.filter(posts=>{\r\n                        return posts._id !== post._id;\r\n                    })\r\n                })\r\n\r\n                alert(\"Memory deleted\");\r\n            }\r\n            else{\r\n                alert(\"Opps something went wrong with the server!\")\r\n            }\r\n        })\r\n    }\r\n\r\n    function formatDate(date) {\r\n        const today = new Date(parseInt(Date.parse(date), 10));\r\n        var dd = String(today.getDate()).padStart(2, '0');\r\n        var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\r\n        var yyyy = today.getFullYear();\r\n        return dd + \" \" + monthMap[mm]+\" \"+yyyy\r\n      }\r\n\r\n    return<div className=\"post-div\">\r\n        {openMore&&<div className=\"post-more-div\">\r\n            <div className=\"post-more-option edit\" onClick={handleEdit}>\r\n            Edit Memory\r\n            </div>\r\n            <div className=\"post-more-option delete\" onClick={deletePost}>\r\n            Delete Memory\r\n            </div>\r\n            </div>}\r\n        <IconButton id=\"post-more\" onClick={()=>setOpenMore(!openMore)}><MoreHorizIcon fontSize=\"medium\"/></IconButton>\r\n        <div className=\"post-header\">\r\n            {userId===post.userId?<ReactAvatar src=\"/gridFs/getProfile\" id=\"post-avatar\"/>:<ReactAvatar src=\"/gridFs/getPartnerProfile\" id=\"post-avatar\"/>}\r\n           <div className=\"post-desc\">\r\n            <div className=\"post-feeling\">\r\n                <h3>{post.nickname}</h3>\r\n                {post.feeling&&<h3> &nbsp;‚Ä¢ &nbsp;is feeling {post.feeling}&nbsp;{emojiMap[post.feeling]}</h3>}  \r\n            </div>\r\n              <div className=\"post-time\">\r\n                <p>{formatDate(post.timeOfCreation)}</p>\r\n              </div>\r\n            </div> \r\n        </div>\r\n        <div className=\"post-text\">\r\n        {post.text}\r\n        </div>\r\n        <div className=\"post-images\">\r\n        {post.fileId&&\r\n            <ImageGallery items={constructGalleryUrls(post.fileId)} showFullscreenButton={false} showPlayButton={false} showThumbnails={false} className=\"post-gallery\" />\r\n        }\r\n        </div>\r\n    </div>\r\n}"]},"metadata":{},"sourceType":"module"}